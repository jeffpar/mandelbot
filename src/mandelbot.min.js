(function(){/*
 (c) Jeff Parsons 2017

 This file is part of an open-source project (https://github.com/jeffpar/mandelbot) with no formal license.
 All portions not licensed from other sources may be freely reused.  Any derivative work just needs to provide
 attribution along with the above copyright.

 Portions copyright 2012 by Christian Stigen Larsen and licensed under [Apache License](http://www.apache.org/licenses/LICENSE-2.0),
 Version 2.0.  Those portions are clearly identified in [mandelbot.js](https://github.com/jeffpar/mandelbot/blob/master/src/mandelbot.js)
 and must be accompanied by the same Apache License if they are redistributed.
*/
var p=0,r=[],t=0,u=1E3/60|0,v,w;
function x(a,c,b,d,f,e,h,g,k,n){a=void 0===a?0:a;c=void 0===c?0:c;b=void 0===b?y:b;d=void 0===d?z:d;f=void 0===f?A:f;e=void 0===e?B:e;C(this,k);this.j=h||!1;this.da=void 0!==g?g:x.COLOR_SCHEME.GRAY;this.Z=[0,0,0,0];this.M=[];try{this.$(x.CONTROL_STATUS,n);var l;a:if(this.U=k,this.w=this.v=0,k){if(this.H=document.getElementById(k))if(this.w=this.H.width,this.v=this.H.height,this.u=this.H.getContext("2d")){this.u.imageSmoothingEnabled=!1;D(this,this.H);l=!0;break a}E(this,"Missing view canvas");l=!1}else l=
!0;var m;if(m=l)a:{var q=a||this.w,T=c||this.v;if(this.D=document.createElement("canvas"))if(this.D.width=this.a=q||200,this.D.height=this.b=T||200,this.G=this.D.getContext("2d"))if(this.m=this.G.createImageData(this.a,this.b)){m=!0;break a}E(this,"Unable to create grid canvas");m=!1}m&&(this.W=F(this,G,this.ha=b),this.X=F(this,H,this.ia=d),this.S=F(this,I,this.ea=f,!0),this.T=F(this,J,this.fa=e,!0),K(this,this.W,this.X,this.S,this.T,!1))}catch(U){E(this,U.message)}}
x.prototype.$=function(a,c){var b=this,d=c?document.getElementById(c):null;switch(a){case x.CONTROL_STATUS:this.Y=d;E(this);break;case x.CONTROL_RESET:d&&(d.onclick=function(){b.M=[];L(b);b.J==b.W&&b.K==b.X&&b.h==b.S&&b.i==b.T?K(b,y,z,A,B):K(b,b.W,b.X,b.S,b.T)});E(this);break;case x.CONTROL_PREVIOUS:if(this.R=d)d.onclick=function(){var a=b.M.pop();if(null!=a){C(b,b.U,a);var a=F(b,G,b.ha),c=F(b,H,b.ia),d=F(b,I,b.ea),g=F(b,J,b.fa);K(b,a,c,d,g);L(b)}};L(this)}};
function D(a,c){a.N||(a.N=c,a.I=a.O=-1,a.V=0,a.g=a.o=-1,a.c=a.f=0,a.ga=!1,c.addEventListener("touchstart",function(b){M(a,b,!0)}),c.addEventListener("touchmove",function(b){M(a,b)}),c.addEventListener("touchend",function(b){M(a,b,!1)}),c.addEventListener("mousedown",function(b){M(a,b,!0)}),c.addEventListener("mousemove",function(b){0<=a.I&&M(a,b)}),c.addEventListener("mouseup",function(b){M(a,b,!1)}))}
function M(a,c,b){var d,f;c=c||window.event;c.targetTouches&&c.targetTouches.length?(d=c.targetTouches[0].pageX,f=c.targetTouches[0].pageY):(d=c.pageX,f=c.pageY);var e=0,h=0,g=a.N;do isNaN(g.offsetLeft)||(e+=g.offsetLeft,h+=g.offsetTop);while(g=g.offsetParent);d=a.w/a.N.offsetWidth*(d-e);f=a.v/a.N.offsetHeight*(f-h);d=Math.round(a.a*d/a.w);f=Math.round(a.b*f/a.v);a.ga||c.preventDefault();0<=a.g&&a.G.putImageData(a.m,0,0);if(b)a.I=d,a.O=f,a.V=Date.now();else if(!1!==b)(a.g=a.I,a.o=a.O,a.c=d-a.g,a.f=
f-a.o,a.c&&a.f)?Math.abs(a.c/a.f)!=Math.abs(a.a/a.b)&&(d=Math.abs(a.a*a.f/a.b),a.c=0>a.c?-d:d):a.c=a.f=0;else{c=Date.now()-a.V;if(d==a.I&&f==a.O||100>c)a.c&&a.f?(b=a.g,c=a.o,h=a.g+a.c,e=a.o+a.f,0>h?h=0:h>a.a&&(h=a.a),0>e?e=0:e>a.b&&(e=a.b),h<b&&(b=h,h=a.g),e<c&&(c=e,e=a.o),d>=b&&d<=h&&f>=c&&f<=e&&!a.j&&(d=(h-b)*a.A/2,f=(e-c)*a.B/2,b=a.s+b*a.A+d,c=a.L-c*a.B-f,K(a,b,c,d,f,!0)),a.c=a.f=0):a.c||a.f||a.j||(b=a.s+d*a.A,c=a.L-f*a.B,K(a,b,c,a.h,a.i,!0)),a.g=a.o=-1;a.I=a.O=-1;a.V=0}0<=a.g&&(a.G.lineWidth=
1,a.G.strokeStyle="#00FF00",a.G.strokeRect(a.g,a.o,a.c,a.f));a.u&&a.u.drawImage(a.D,0,0,a.a,a.b,0,0,a.w,a.v)}
function K(a,c,b,d,f,e){a.J=c;a.K=b;a.h=d;a.i=f;a.F=a.P=0;a.j?(a.s=a.J.minus(a.h),a.A=a.h.times(2).dividedBy(a.a).round(20),a.L=a.K.plus(a.i),a.B=a.i.times(2).dividedBy(a.b).round(20),a.l=a.s.plus(0),a.C=a.L.plus(0)):(a.s=a.J-a.h,a.A=2*a.h/a.a,a.L=a.K+a.i,a.B=2*a.i/a.b,a.l=a.s,a.C=a.L);c=a.h;b=a.i;var h;"number"==typeof c?h=Math.min(c,b):h=BigNumber.min(c,b);a.ca=Math.floor(223/Math.sqrt(.001+4*h));E(a,"X: "+a.J+" (+/-"+a.h+") Y: "+a.K+" (+/-"+a.i+") Iterations: "+a.ca+(a.j?" (BigNumbers)":""));!1!==
e&&(a.U&&(e&&(a.M.push(location.hash),L(a)),e=N+"="+a.U,e+="&"+G+"="+a.J,e+="&"+H+"="+a.K,e+="&"+I+"="+a.h,e+="&"+J+"="+a.i,location.hash=e),O(!0))}function C(a,c,b){b=void 0===b?location.hash:b;a.aa={};if(c){for(var d={},f,e=/([^#&=]+)=([^&]*)/g;f=e.exec(b);)d[f[1]]=f[2];d[N]==c&&(a.aa=d)}}function F(a,c,b,d){b=a.aa[c]||b;a.j?(a=new BigNumber(b),d&&(a=a.abs())):(a=+b,d&&(a=Math.abs(a)));return a}
function L(a){a.R&&(a.M.length?a.R.removeAttribute("disabled"):a.R.setAttribute("disabled","disabled"))}function E(a,c){if(c=c||a.ba)a.Y?(a.Y.textContent=c,a.ba=""):a.ba=c}function P(a){var c=0,b=8,c=void 0===c?0:c,b=void 0===b?1:b;a=void 0===a?!1:a;var d=0,f=0;do{var e=0,h=Date.now(),g,k=50;do{k*=2;g=a?new BigNumber(-.5):-.5;var n=a?new BigNumber(0):0,n=Q(g,n,c+k);g=Date.now()-h;if(g>=u)break;e+=c+k-n;c=0}while(1);d+=e;b&&(c=Math.floor(e/b));f++}while(0<--b);return Math.floor(d/f)}
function Q(a,c,b,d){var f=b=b||100,e=0,h=0;if("number"==typeof a){var g=0,k=0,n;do k=2*g*k+c,g=e-h+a,n=(e=g*g)+(h=k*k);while(0<--f&&4>n);if(f&&d){n=4;do k=2*g*k+c,g=e-h+a,e=g*g,h=k*k;while(0<--n)}}else{g=new BigNumber(0);k=new BigNumber(0);n=new BigNumber(0);var l=new BigNumber(0);do k=g.times(k).times(2).plus(c).round(20),g=n.minus(l).plus(a),n=g.times(g).round(20),l=k.times(k).round(20);while(0<--f&&n.plus(l).lt(4));if(f&&d){e=4;do k=g.times(k).times(2).plus(c).round(20),g=n.minus(l).plus(a),n=
g.times(g).round(20),l=k.times(k).round(20);while(0<--e);e=n.toNumber();h=l.toNumber()}}d&&(d[0]=b,d[1]=f,d[2]=e,d[3]=h);return f}function R(a,c){1<c&&(c=1);var b=a/60,d=1*c,f=d*(1-Math.abs(b%2-1)),e=0,h=0,g=0;1>b?(e=d,h=f):2>b?(e=f,h=d):3>b?(h=d,g=f):4>b?(h=f,g=d):5>b?(e=f,g=d):(e=d,g=f);b=c-d;return 255*(e+b)&255|(255*(h+b)&255)<<8|(255*(g+b)&255)<<16}var y=-.5,z=0,A=1.5,B=1.5,S=1/Math.log(2),V=Math.log(.5)*S,N="id",G="xCenter",H="yCenter",I="dxCenter",J="dyCenter";
x.COLOR_SCHEME={BW:0,HSV1:1,HSV2:2,HSV3:3,GRAY:4};x.CONTROL_STATUS="status";x.CONTROL_RESET="reset";x.CONTROL_PREVIOUS="previous";v=P();w=P(!0);
function O(a){if(!a){p=0;for(var c=r.length;c--;){for(var b=r[t],d=!1,f=b.F,e=b.P,h=0,g=0,k=Math.floor((b.j?w:v)/r.length);b.P<b.b;){for(;0<k&&b.F<b.a;){var d=b.ca,n=Q(b.l,b.C,d,b.Z),l=b.Z,m=0;if(l[1]){var q=!0,m=5+(l[0]-l[1])-V-Math.log(Math.log(l[2]+l[3]))*S;switch(b.da){default:m=-1;break;case x.COLOR_SCHEME.HSV1:m=R(360*m/l[0],1);break;case x.COLOR_SCHEME.HSV2:q=!1;case x.COLOR_SCHEME.HSV3:m=R(360*m/l[0],10*m/l[0]);q&&(m=m&4278255360|m>>16&255|(m&255)<<16);break;case x.COLOR_SCHEME.GRAY:m=Math.floor(512*
m/l[0]),255<m&&(m=255),m=m|m<<8|m<<16}}l=b;q=4*(b.P*l.a+b.F);l.m.data[q]=m&255;l.m.data[q+1]=m>>8&255;l.m.data[q+2]=m>>16&255;l.m.data[q+3]=255;b.j?b.l=b.l.plus(b.A):b.l+=b.A;b.F++;g||h++;k-=d-n;d=!0}if(0>=k)break;b.F=0;b.j?(b.l=b.s.plus(0),b.C=b.C.minus(b.B)):(b.l=b.s,b.C-=b.B);b.P++;g++;f=0;h=b.a}d&&(0<b.F&&g++,h=void 0===h?b.a:h,g=void 0===g?b.b:g,b.G.putImageData(b.m,0,0,void 0===f?0:f,void 0===e?0:e,h,g),b.u&&b.u.drawImage(b.D,0,0,b.a,b.b,0,0,b.w,b.v));d&&(a=!0);++t>=r.length&&(t=0)}}a&&!p&&
(p=setTimeout(O,0))}window.Mandelbot=x;x.prototype.addControl=x.prototype.$;window.newMandelbot=function(a,c,b,d,f,e,h,g,k,n,l){l=void 0===l?!0:l;a=new x(a,c,b,d,f,e,h,g,k,n);l&&(r.push(a),O(!0));return a};})() //# sourceMappingURL=/src/mandelbot.js.map
