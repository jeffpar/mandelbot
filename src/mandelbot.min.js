(function(){/*
 (c) Jeff Parsons 2017

 This file is part of an open-source project (https://github.com/jeffpar/mandelbot) with no formal license.
 All portions not licensed from other sources may be freely reused.  Any derivative work just needs to provide
 attribution along with the above copyright.

 Portions copyright 2012 by Christian Stigen Larsen and licensed under [Apache License](http://www.apache.org/licenses/LICENSE-2.0),
 Version 2.0.  Those portions are clearly identified in [mandelbot.js](https://github.com/jeffpar/mandelbot/blob/master/src/mandelbot.js)
 and must be accompanied by the same Apache License if they are redistributed.
*/
var q=0,r=[],t=0,v=1E3/60|0,x,y;
function z(a,c,b,d,f,g,h,e,k,n){a=void 0===a?0:a;c=void 0===c?0:c;b=void 0===b?-.5:b;d=void 0===d?0:d;f=void 0===f?1.5:f;g=void 0===g?1.5:g;h=void 0===h?!1:h;this.T={};if(k){for(var m={},p,l=location.hash,P=/([^#&=]+)=([^&]*)/g;p=P.exec(l);)m[p[1]]=p[2];m[A]==k&&(this.T=m)}this.j=h;this.A=B(this,C,b);this.C=B(this,D,d);this.h=B(this,E,f,!0);this.i=B(this,F,g,!0);this.W=void 0!==e?e:G;this.R=[0,0,0,0];try{this.S=n?document.getElementById(n):void 0;var u;a:if(this.U=k,this.w=this.v=0,k){if(this.J=document.getElementById(k))if(this.w=
this.J.width,this.v=this.J.height,this.u=this.J.getContext("2d")){this.u.imageSmoothingEnabled=!1;H(this,this.J);u=!0;break a}I(this,"Missing view canvas");u=!1}else u=!0;var w;if(w=u)a:{var R=a||this.w,S=c||this.v;if(this.G=document.createElement("canvas"))if(this.G.width=this.a=R||200,this.G.height=this.b=S||200,this.I=this.G.getContext("2d"))if(this.m=this.I.createImageData(this.a,this.b)){w=!0;break a}I(this,"Unable to create grid canvas");w=!1}w&&J(this)}catch(T){I(this,T.message)}}
function H(a,c){a.M||(a.M=c,a.K=a.N=-1,a.P=0,a.g=a.o=-1,a.c=a.f=0,a.X=!1,c.addEventListener("touchstart",function(b){K(a,b,!0)}),c.addEventListener("touchmove",function(b){K(a,b)}),c.addEventListener("touchend",function(b){K(a,b,!1)}),c.addEventListener("mousedown",function(b){K(a,b,!0)}),c.addEventListener("mousemove",function(b){0<=a.K&&K(a,b)}),c.addEventListener("mouseup",function(b){K(a,b,!1)}))}
function K(a,c,b){var d,f;c=c||window.event;c.targetTouches&&c.targetTouches.length?(d=c.targetTouches[0].pageX,f=c.targetTouches[0].pageY):(d=c.pageX,f=c.pageY);var g=0,h=0,e=a.M;do isNaN(e.offsetLeft)||(g+=e.offsetLeft,h+=e.offsetTop);while(e=e.offsetParent);d=a.w/a.M.offsetWidth*(d-g);f=a.v/a.M.offsetHeight*(f-h);d=Math.round(a.a*d/a.w);f=Math.round(a.b*f/a.v);a.X||c.preventDefault();0<=a.g&&a.I.putImageData(a.m,0,0);if(b)a.K=d,a.N=f,a.P=Date.now();else if(!1!==b)(a.g=a.K,a.o=a.N,a.c=d-a.g,a.f=
f-a.o,a.c&&a.f)?Math.abs(a.c/a.f)!=Math.abs(a.a/a.b)&&(d=Math.abs(a.a*a.f/a.b),a.c=0>a.c?-d:d):a.c=a.f=0;else{c=Date.now()-a.P;if(d==a.K&&f==a.N||100>c)a.c&&a.f?(c=a.g,b=a.o,g=a.g+a.c,h=a.o+a.f,0>g?g=0:g>a.a&&(g=a.a),0>h?h=0:h>a.b&&(h=a.b),g<c&&(c=g,g=a.g),h<b&&(b=h,h=a.o),d>=c&&d<=g&&f>=b&&f<=h&&(a.j||(a.h=(g-c)*a.B/2,a.i=(h-b)*a.D/2,a.A=a.s+c*a.B+a.h,a.C=a.L-b*a.D-a.i),J(a,!0)),a.c=a.f=0):a.c||a.f||(a.j||(a.A=a.s+d*a.B,a.C=a.L-f*a.D),J(a,!0)),a.g=a.o=-1;a.K=a.N=-1;a.P=0}0<=a.g&&(a.I.lineWidth=1,
a.I.strokeStyle="#00FF00",a.I.strokeRect(a.g,a.o,a.c,a.f));a.u&&a.u.drawImage(a.G,0,0,a.a,a.b,0,0,a.w,a.v)}
function J(a,c){a.H=a.O=0;a.j?(a.s=a.A.minus(a.h),a.B=a.h.times(2).dividedBy(a.a).round(20),a.L=a.C.plus(a.i),a.D=a.i.times(2).dividedBy(a.b).round(20),a.l=a.s.plus(0),a.F=a.L.plus(0)):(a.s=a.A-a.h,a.B=2*a.h/a.a,a.L=a.C+a.i,a.D=2*a.i/a.b,a.l=a.s,a.F=a.L);var b=a.h,d=a.i,f;"number"==typeof b?f=Math.min(b,d):f=BigNumber.min(b,d);a.V=Math.floor(223/Math.sqrt(.001+4*f));I(a,"X: "+a.A+" (+/-"+a.h+") Y: "+a.C+" (+/-"+a.i+") Iterations: "+a.V+(a.j?" (BigNumbers)":""));c&&(a.U&&(b=A+"="+a.U,b+="&"+C+"="+
a.A,b+="&"+D+"="+a.C,b+="&"+E+"="+a.h,b+="&"+F+"="+a.i,location.hash=b),L(!0))}function B(a,c,b,d){b=a.T[c]||b;a.j?(a=new BigNumber(b),d&&(a=a.abs())):(a=+b,d&&(a=Math.abs(a)));return a}function I(a,c){c&&a.S&&(a.S.textContent=c)}
function M(a){var c=0,b=8,c=void 0===c?0:c,b=void 0===b?1:b;a=void 0===a?!1:a;var d=0,f=0;do{var g=0,h=Date.now(),e,k=50;do{k*=2;e=a?new BigNumber(-.5):-.5;var n=a?new BigNumber(0):0,n=N(e,n,c+k);e=Date.now()-h;if(e>=v)break;g+=c+k-n;c=0}while(1);d+=g;b&&(c=Math.floor(g/b));f++}while(0<--b);return Math.floor(d/f)}
function N(a,c,b,d){var f=b=b||100,g=0,h=0;if("number"==typeof a){var e=0,k=0,n;do k=2*e*k+c,e=g-h+a,n=(g=e*e)+(h=k*k);while(0<--f&&4>n);if(f&&d){n=4;do k=2*e*k+c,e=g-h+a,g=e*e,h=k*k;while(0<--n)}}else{e=new BigNumber(0);k=new BigNumber(0);n=new BigNumber(0);var m=new BigNumber(0);do k=e.times(k).times(2).plus(c).round(20),e=n.minus(m).plus(a),n=e.times(e).round(20),m=k.times(k).round(20);while(0<--f&&n.plus(m).lt(4));if(f&&d){g=4;do k=e.times(k).times(2).plus(c).round(20),e=n.minus(m).plus(a),n=
e.times(e).round(20),m=k.times(k).round(20);while(0<--g);g=n.toNumber();h=m.toNumber()}}d&&(d[0]=b,d[1]=f,d[2]=g,d[3]=h);return f}function O(a,c){1<c&&(c=1);var b=a/60,d=1*c,f=d*(1-Math.abs(b%2-1)),g=0,h=0,e=0;1>b?(g=d,h=f):2>b?(g=f,h=d):3>b?(h=d,e=f):4>b?(h=f,e=d):5>b?(g=f,e=d):(g=d,e=f);b=c-d;return 255*(g+b)&255|(255*(h+b)&255)<<8|(255*(e+b)&255)<<16}var A="id",C="xCenter",D="yCenter",E="xDistance",F="yDistance",Q=1,U=2,V=3,G=4,W=1/Math.log(2),X=Math.log(.5)*W;x=M();y=M(!0);
function L(a){if(!a){q=0;for(var c=r.length;c--;){for(var b=r[t],d=!1,f=b.H,g=b.O,h=0,e=0,k=Math.floor((b.j?y:x)/r.length);b.O<b.b;){for(;0<k&&b.H<b.a;){var d=b.V,n=N(b.l,b.F,d,b.R),m=b.W,p=b.R,l=0;if(p[1])switch(l=5+(p[0]-p[1])-X-Math.log(Math.log(p[2]+p[3]))*W,m){default:l=-1;break;case Q:l=O(360*l/p[0],1);break;case U:case V:l=O(360*l/p[0],10*l/p[0]);3==m&&(l=l&4278255360|l>>16&255|(l&255)<<16);break;case G:l=Math.floor(512*l/p[0]),255<l&&(l=255),l=l|l<<8|l<<16}m=b;p=l;l=4*(b.O*m.a+b.H);m.m.data[l]=
p&255;m.m.data[l+1]=p>>8&255;m.m.data[l+2]=p>>16&255;m.m.data[l+3]=255;b.j?b.l=b.l.plus(b.B):b.l+=b.B;b.H++;e||h++;k-=d-n;d=!0}if(0>=k)break;b.H=0;b.j?(b.l=b.s.plus(0),b.F=b.F.minus(b.D)):(b.l=b.s,b.F-=b.D);b.O++;e++;f=0;h=b.a}d&&(0<b.H&&e++,h=void 0===h?b.a:h,e=void 0===e?b.b:e,b.I.putImageData(b.m,0,0,void 0===f?0:f,void 0===g?0:g,h,e),b.u&&b.u.drawImage(b.G,0,0,b.a,b.b,0,0,b.w,b.v));d&&(a=!0);++t>=r.length&&(t=0)}}a&&!q&&(q=setTimeout(L,0))}
window.initMandelbot=function(a,c,b,d,f,g,h,e,k,n,m){m=void 0===m?!0:m;a=new z(a,c,b,d,f,g,h,e,k,n);m&&(r.push(a),L(!0));return a};})() //# sourceMappingURL=/src/mandelbot.js.map
